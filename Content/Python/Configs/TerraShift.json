{
  "environment": {
    "name": "TerraShift",
    "id": "3",
    "params": {
      "PlatformSize": 1,
      "MaxColumnHeight": 4,
      "ObjectSize": [0.1, 0.1, 0.1],
      "ObjectMass": 0.1,
      "GridSize": 50,
      "MaxSteps": 512,
      "NumGoals": 4,
      "SpawnDelay": 0.25,
      "MaxAgents": 100,
      "GoalThreshold": 1.75,

      "MultiAgentGaussianWaveHeightMap": {
        "num_agents": 100,
        "grid_size": 50,
        "min_height": -4.0,
        "max_height": 4.0,
        "velocity_minmax":   [-1.0, 1.0],
        "amplitude_minmax":  [0.0, 5.0],
        "sigma_minmax":      [0.2, 5.0],
        "angular_vel_minmax":[-0.5, 0.5],
        "action_dim": 6,
        "bUseActionDelta": true,
        "delta_velocity_scale": 0.5,
        "delta_amp_scale":      0.2,
        "delta_sigma_scale":    0.05,
        "delta_angvel_scale":   0.3
      },

      "StateManager": {
        "max_grid_objects": 5,
        "GoalThreshold": 1.75,
        "MarginXY": 1.5,
        "MinZ": 0.0,
        "MaxZ": 300.0,
        "SpawnCollisionRadius": 1.0,
        "MarginCells": 4,
        "BoundingSphereScale": 1.0,
        "ObjectScale": 0.1,
        "ObjectMass": 0.1,
        "max_column_height": 4.0,
        "bUseRaycastForHeight": true,
        "base_respawn_delay": 0.0
      }
    },

    "shape": {
      "state": {
        "central": {
          "obs_size": 25000
        },
        "agent": {
          "obs_size": 9,
          "min": 50,
          "max": 50
        }
      },
      "action": {
        "agent": {
          "continuous": [
            { "min": -1, "max": 1 },
            { "min": -1, "max": 1 },
            { "min": -1, "max": 1 },
            { "min": -1, "max": 1 },
            { "min": -1, "max": 1 },
            { "min": -1, "max": 1 }
          ]
        }
      }
    }
  },

  "agent": {
    "type": "MA_POCA",
    "params": {
      "learning_rate": 0.00002,
      "gamma": 0.99,
      "lambda": 0.95,
      "value_loss_coeff": 0.1,
      "baseline_loss_coeff": 0.1,
      "normalize_advantages": false,
      "clipped_value_loss": true,
      "max_grad_norm": 0.1,
      "ppo_clip_range": 0.1,
      "value_clip_range": 0.2,
      "entropy_coeff": 0.001,
      "rewards_normalizer_disabled": {
        "warmup_steps": 10000
      },
      "schedulers": {
        "lr": {
          "start_factor": 1,
          "end_factor": 0.01,
          "total_iters": 100000
        },
        "entropy_coeff": {
          "start_value": 0.001,
          "end_value": 0.0001,
          "total_iters": 100000
        }
      },
      "networks": {
        "MultiAgentEmbeddingNetwork": {
          "cross_attention_feature_extractor": {
            "in_channels": 10,
            "h": 50,
            "w": 50,
            "embed_dim": 64,
            "num_heads": 8,
            "cnn_channels": [32, 64, 128],
            "cnn_kernel_sizes": [5, 3, 3],
            "cnn_strides": [2, 2, 2],
            "group_norms": [16, 8, 4],
            "block_scales": [12, 6, 3],
            "transformer_layers": 2,
            "dropout_rate": 0.0,
            "use_agent_id": true,
            "ff_hidden_factor": 4,
            "id_num_freqs": 256,
            "conv_init_scale": 0.1,
            "linear_init_scale": 0.1
          },
          "obs_encoder": {
            "state_dim": 64,
            "hidden_size": 64,
            "output_size": 64,
            "dropout_rate": 0,
            "activation": true,
            "layer_norm": true,
            "linear_init_scale": 0.1
          },
          "obs_actions_encoder": {
            "state_dim": 64,
            "action_dim": 6,
            "hidden_size": 64,
            "output_size": 64,
            "dropout_rate": 0,
            "activation": true,
            "layer_norm": true,
            "linear_init_scale": 0.1
          }
        },
        "policy_network": {
          "in_features": 64,
          "hidden_size": 256,
          "log_std_min": -8.0,
          "log_std_max": 2.0,
          "mean_scale": 1.0,
          "entropy_method": "mc",
          "n_entropy_samples": 10,
          "num_agents": 50,
          "linear_init_scale": 0.1
        },
        "critic_network": {
          "value_head": {
            "in_features": 64,
            "hidden_size": 256,
            "dropout_rate": 0
          },
          "baseline_head": {
            "in_features": 64,
            "hidden_size": 256,
            "dropout_rate": 0
          },
          "baseline_attention": {
            "embed_dim": 64,
            "num_heads": 8,
            "dropout": 0.0,
            "self_attention": true
          },
          "linear_init_scale": 0.1
        }
      }
    }
  },

  "train": {
    "states_normalizer": {
      "warmup_steps": 10000
    },
    "num_environments": 2,
    "epochs": 4,
    "mini_batch_size": 8,
    "buffer_size": 64,
    "batch_size": 64,
    "AgentsResetFrequency": 0,
    "ActionRepeat": 3,
    "saveFrequency": 20
  }
}
